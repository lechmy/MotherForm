function AjaxForm(t){const a="[MotherForm] | Error:",n={NONE:"none",PAGE:"pagination",SCROLL:"infinite-scroll",LOAD:"load-more"},e={MINIMAL:"< (x/y) >",BASIC:"< [5] >",STANDARD:"<< < [5] > >>",EXTENDED:"<< < ~ >... [5] ...< ~ > >>"},i={form:"",container:"",additionalData:{},queryParams:!1,pagination:{type:n.NONE,pattern:e.BASIC,container:"",pageSize:0,pageCount:0,totalCount:0},paginationModel:{response:"data",pageSize:"pagesize",pageNumber:"pagenumber",pageCount:"pageCount",totalCount:"totalCount"},beforesend:()=>{},response:t=>{this.conf.pagination.type==n.LOAD||this.conf.pagination.type==n.SCROLL?this.conf.container.insertAdjacentHTML("beforeend",t):this.conf.container.innerHTML=t}};return this.conf={},this.events=["change","submit"],this.xhttp=new XMLHttpRequest,this.paginationPattern=e,this.activePage=1,this.paginationEnabled=!1,this.pageCount=1,this.IsBusy=!1,this.parseDataAtt=(t=>{let a=this.conf.form.getAttribute(t);return null!=a?JSON.parse(a.replaceAll("'",'"')):null}),this.toBool=(t=>null==t?null:"true"==val.toLowerCase()),this.setForm=(t=>{try{if(this.conf.form="string"==typeof t?document.querySelector(t):t,null==this.conf.form)throw new Error}catch(t){throw new SyntaxError(`${a} Form not found`)}}),this.setContainer=(()=>{try{let t=this.conf.form.getAttribute("data-mf-container");if(t=null!=t?t:this.conf.container,this.conf.container=document.querySelector(t),null==this.conf.container)throw new Error}catch(t){throw new SyntaxError(`${a} Container not found`)}}),this.setQueryParamsSettings=(()=>{let t=this.conf.form.getAttribute("data-mf-query-params");t=this.toBool(t),this.conf.queryParams=null!=t?t:this.conf.queryParams}),this.setAdditionalData=(t=>{let a=this.parseDataAtt("data-mf-pgn");a=null!=a?a:null,this.conf.additionalData=t||a||this.conf.additionalData}),this.setPaginationContainer=(()=>{try{let t=document.querySelector(this.conf.pagination.container);if(null==t)throw new Error;this.conf.pagination.container=t}catch(t){throw new Error(`${a} Pagination container not found`)}this.conf.pagination.container.classList.add("mf-pagination-container")}),this.setTotalCount=(t=>{let a=this.parseDataAtt("data-mf-pgn");a=null!=a?parseInt(a.totalCount):null,this.conf.pagination.totalCount=t||a||this.conf.pagination.totalCount}),this.setPageSize=(t=>{let a=this.parseDataAtt("data-mf-pgn");a=null!=a?parseInt(a.pageSize):null,this.conf.pagination.pageSize=t||a||this.conf.pagination.pageSize}),this.setPageCount=(t=>{let a=this.parseDataAtt("data-mf-pgn"),n=t||a.pageCount,e=parseInt(n),i=Math.floor(this.conf.pagination.totalCount/this.conf.pagination.pageSize)||1;this.activePage=this.activePage>e?e:this.activePage,this.pageCount=e||i||this.conf.pagination.pageCount}),this.setPaginationParameters=(()=>{let t=this.parseDataAtt("data-mf-pgn");null!=t&&Object.assign(this.conf.pagination,t)}),this.setPaginationModel=(()=>{let t=this.parseDataAtt("data-mf-pgn-model");null!=t&&Object.assign(this.conf.paginationModel,t)}),this.readystatechange=(()=>{if(this.xhttp.readyState===XMLHttpRequest.DONE)if(200===this.xhttp.status){let t=this.xhttp.response;this.paginationEnabled&&(this.setPageSize(this.xhttp.response[this.conf.paginationModel.pageSize]),this.setTotalCount(this.xhttp.response[this.conf.paginationModel.totalCount]),this.setPageCount(this.xhttp.response[this.conf.paginationModel.pageCount]),this.paginationEnabled&&(this.conf.pagination.type==n.PAGE&&this.renderPagination(),this.conf.pagination.type==n.LOAD&&this.renderLoadMore()),t=this.xhttp.response[this.conf.paginationModel.response]||t),this.conf.response(t)}else console.error(`${a} There was a problem with the request. status code: ${this.xhttp.status}`)}),this.loadstart=(()=>{this.conf.container.classList.add("mf-loading"),this.conf.beforesend(),this.IsBusy=!0}),this.loadend=(()=>{setTimeout(()=>{this.conf.container.classList.remove("mf-loading"),this.IsBusy=!1},300)}),this.setData=(()=>{const t=this.conf.form;let n=this.getFormData(t);if(null===n)return console.error(`${a} Parsing form didn't gather data, make sure you add 'name' attribute to <input> elements`),!1;!0===this.conf.queryParams&&this.setQueryParams(n);const e={url:t.action,method:t.method,data:n};this.sendFormData(e)}),this.sendFormData=(t=>{if("post"==t.method.toLowerCase())this.xhttp.open(t.method,t.url,!0),this.xhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhttp.send(t.data);else{const a=t.url+"?"+t.data;this.xhttp.open(t.method,a,!0),this.xhttp.send()}}),this.getFormData=(t=>{let a="";for(let n of t.elements)null!=n.attributes.name&&""!=n.attributes.name.value.trim()&&(a+=n.attributes.name.value+"="+encodeURIComponent(n.value)+"&");if(this.paginationEnabled){let t=this.conf.pagination,n=this.conf.paginationModel;null!==n.pageSize&&(a+=n.pageSize+"="+t.pageSize+"&"),null!==n.pageNumber&&(a+=n.pageNumber+"="+this.activePage+"&")}return""!=a?a.slice(0,-1):null}),this.setQueryParams=(t=>{let a=location.pathname;"/"==a.slice(-1)?a=a.slice(0,-1)+"?":a+="?",a+=t,window.history.replaceState(null,"",a)}),this.setPage=(t=>{if(this.IsBusy)return!1;let a=this.activePage;const n=t.currentTarget.getAttribute("data-mf-pgn-page");switch(n){case"first":this.activePage=1;break;case"prev":this.activePage=this.activePage>1?this.activePage-1:1;break;case"next":this.activePage=this.activePage<this.pageCount?this.activePage+1:this.pageCount;break;case"last":this.activePage=this.pageCount;break;default:this.activePage=parseInt(n)}if(this.activePage==a)return!1;this.setData()}),this.getRenderConfig=(()=>{let t=this.parsePaginationRange(this.conf.pagination.pattern);if(null==t)return element=null,console.error(`${a} Parameter number of pages is not a number`),{firstDot:!1,firstBtn:!1,lastBtn:!1,lastDot:!1,rangeStart:0,rangeStop:-1};if(this.pageCount-t<=1)return{firstDot:!1,firstBtn:!1,lastBtn:!1,lastDot:!1,rangeStart:1,rangeStop:this.pageCount};let n=0,e=Math.floor(t/2),i=this.activePage-(e+n);i<e&&(i=1);let s=i+t-1;this.pageCount-s<2&&(i=this.pageCount-t+1,s=this.pageCount);let o=i>2,r=i>1,h=s<this.pageCount-1,p=s<this.pageCount;return{firstDot:o,firstBtn:r,lastDot:h,lastBtn:p,rangeStart:i,rangeStop:s}}),this.renderPagination=(()=>{this.conf.pagination.container.innerHTML="";let t=this.conf.pagination.pattern.split(" "),a=this.getRenderConfig();t.forEach(t=>{let n="",e="",i="";switch(t){case"<<":n='<button class="mf-pgn-btn mf-pgn-first" data-mf-pgn-page="first"><span class="mf-icon-first"></span></button>';break;case"<":n='<button class="mf-pgn-btn mf-pgn-prev" data-mf-pgn-page="prev"><span class="mf-icon-prev"></span></button>';break;case">":n='<button class="mf-pgn-btn mf-pgn-next" data-mf-pgn-page="next"><span class="mf-icon-next"></span></button>';break;case">>":n='<button class="mf-pgn-btn mf-pgn-last" data-mf-pgn-page="last"><span class="mf-icon-last"></span></button>';break;case">...":e=a.firstBtn?'<button class="mf-pgn-btn" data-mf-pgn-page="first">1</button>':"",i=a.firstDot?'<span class="mf-pgn-dots">...</span>':"",n=e+i;break;case"...<":e=a.lastBtn?`<button class="mf-pgn-btn" data-mf-pgn-page="last">${this.pageCount}</button>`:"",i=a.lastDot?'<span class="mf-pgn-dots">...</span>':"",n=i+e;break;case"(x/y)":n=`<span class="mf-pgn-count">${this.activePage} / ${this.pageCount}</span>`;break;case"...":n='<span class="mf-pgn-dots">...</span>';break;case"~":n='<span class="mf-pgn-space"></span>';break;default:for(let t=a.rangeStart;t<=a.rangeStop;t++)n+=`<button class="mf-pgn-btn${this.activePage==t?" active":""}" data-mf-pgn-page="${t}">${t}</button>`}null!==n&&this.conf.pagination.container.insertAdjacentHTML("beforeend",n)}),document.querySelectorAll("[data-mf-pgn-page]").forEach(t=>{t.addEventListener("click",this.setPage)})}),this.parsePaginationRange=(t=>{let a=t.match(/[0-9]{1,2}/);return null!=a&&a.length?parseInt(a[0]):null}),this.renderLoadMore=(()=>{if(this.conf.pagination.container.innerHTML="",this.activePage>=this.pageCount)return!1;let t='<button class="mf-pgn-btn mf-pgn-load-more" data-mf-pgn-page="next">Load More</button>';this.conf.pagination.container.insertAdjacentHTML("beforeend",t),document.querySelector("[data-mf-pgn-page]").addEventListener("click",this.setPage)}),this.setInfiniteScroll=(()=>{document.addEventListener("scroll",t=>{if(this.IsBusy)return!1;this.conf.container.getBoundingClientRect().bottom-window.innerHeight<150&&this.activePage<this.pageCount&&(this.activePage++,this.setData())})}),this.initPagination=(()=>{if(this.setPaginationParameters(),this.setPaginationModel(),this.paginationEnabled=this.conf.pagination.type!==n.NONE,!this.paginationEnabled)return!1;switch(this.setPaginationContainer(),this.setPageCount(),this.conf.pagination.type){case n.PAGE:this.renderPagination();break;case n.SCROLL:this.setInfiniteScroll();break;case n.LOAD:this.renderLoadMore()}}),(()=>{let a=Object.assign({},i.pagination,t.pagination),n=Object.assign({},i.paginationModel,t.paginationModel);this.conf=Object.assign(i,t,{pagination:a},{paginationModel:n}),this.setForm(this.conf.form),this.setContainer(),this.setQueryParamsSettings(),this.initPagination(),this.xhttp.onreadystatechange=this.readystatechange,this.xhttp.onloadstart=this.loadstart,this.xhttp.onloadend=this.loadend,this.events.forEach(t=>{this.conf.form.addEventListener(t,t=>{t.preventDefault(),this.setData()})})})(),this}document.querySelectorAll("[data-mf-init]").forEach(t=>{new AjaxForm({form:t})}),new AjaxForm({form:".mf-init",container:".mf-response-container",queryParams:!0,pagination:{type:"pagination",pattern:"<< < ~ >... [5] ...< ~ > >>",container:".mf-pagination"},paginationModel:{totalCount:"Ukupno"},beforesend:()=>{}});